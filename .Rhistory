missmap(df.neqas, main = "NEQAS",  col = c("yellow", "black"), legend = FALSE)
missmap(df.ecat, main = "ECAT",  col = c("yellow", "black"), legend = FALSE)
summary(df.cqas)
df.cqas
summary(df.cqas)
df.cqas <- select(df.cqas, Date, Assay, Result)
df.cqas
summary(data)
summary(df.neqas)
df.neqas <- select(df.neqas, Date, Assay, Result, Median_Reagent, Median_Overall, IQ_Result)
summary(df.neqas)
df.neqas$Assay
levels(df.cqas)
levels(df.cqas$Assay)
df.cqas <- filter(data, Scheme == "CQAS") %>%
droplevels
dim(df.cqas)
df.neqas <- filter(data, Scheme =="NEQAS") %>% droplevels
df.ecat <- filter(data, Scheme == "ECAT") %>% droplevels
summary(df.cqas)
df.neqas
summary(df.neqas)
df.neqas <- select(df.neqas, Date, Assay, Result, Median_Reagent, Median_Overall, IQ_Result)
df.neqas <- select(df.neqas, Date, Assay, Result, Median_Reagent, Median_Overall, IQ_Result)
summary(df.neqas)
df.neqas %>% arrange(Date)
any(is.na(df.neqas))
complete.cases(df.neqas)
sum(complete.cases(df.neqas))
View(data)
df.neqas.IQ <- filter(df.neqas, IQ_Result != "NA")
library(ggplot2)
ggplot(data=df.neqas, aes(x=IQ_Result)) + geom_histogram()
ggplot(data=df.neqas, aes(x=IQ_Result)) + geom_histogram(stat="count")
df.neqas.IQ <- filter(df.neqas, IQ_Result != "NA") %>% droplevels
ggplot(data=df.neqas, aes(x=IQ_Result)) + geom_histogram(stat="count")
ggplot(data=df.neqas.IQ, aes(x=IQ_Result)) + geom_histogram(stat="count")
levels(df.neqas/df.neqas.IQ)
levels(df.neqas.IQ)
levels(df.neqas.IQ$IQ_Result)
levels(df.neqas.IQ$IQ_Result) <- c("*", "e", "d", "c", "b", "a", "A", "B", "C", "D", "E")
levels(df.neqas.IQ$IQ_Result)
ggplot(data=df.neqas.IQ, aes(x=IQ_Result)) + geom_histogram(stat="count")
df.neqas.IQ <- filter(df.neqas, IQ_Result != "NA") %>% droplevels
levels(df.neqas.IQ$IQ_Result)
ggplot(data=df.neqas.IQ, aes(x=IQ_Result)) + geom_histogram(stat="count")
ggplot(data=df.neqas.IQ, aes(x=IQ_Result)) + geom_bar()
any(is.na(df.neqas))
sum(complete.cases(df.neqas))
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, color=Assay)) + geom_bar()
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar()
summary(df.neqas.IQ)
levels(data$Assay)
data$Assay <- gsub("ADAMTS", "ADAMTS13 activity", data$Assay)
levels(data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("ADAMTS activity-13 Inhibitor", "ADAMTS13 Inhibitor", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("ADAMTS13 activity-13 Inhibitor", "ADAMTS13 Inhibitor", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("ADAMTS13 activity13 Activity", "ADAMTS13 Activity", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("ADAMTS13 activity", "ADAMTS13 Activity", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("ADAMTS13 Activity12 Inhibitor", "ADAMTS13 Inhibitor", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("ADAMTS13 Activity13 Inhibitor", "ADAMTS13 Inhibitor", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("ADAMTS13 Activity-13 Activity", "ADAMTS13 Activity", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Anti Xa", "Anti-Xa", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Anti XA", "Anti-Xa", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Anti-XA", "Anti-Xa", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Anti-XA", "Anti-Xa", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("APTTD", "APTT DADE", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("APTTSP", "APTT SP", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Clauss Fibrinogen", "Fibrinogen", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Dade Actin FS", "APTT DADE", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("EXTAM A10", "EXTEM A10", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("EXTAM A10", "EXTEM A10", data$Assay)
data$Assay <- gsub("EXTEM A10 mm", "EXTEM A10", data$Assay)
data$Assay <- gsub("EXTEM A15 mm", "EXTEM A15", data$Assay)
data$Assay <- gsub("EXTEM A20 mm", "EXTEM A20", data$Assay)
data$Assay <- gsub("EXTEM A30 mm", "EXTEM A30", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("EXTEM Alpha angle", "EXTEM alpha", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("EXTEM angle", "EXTEM alpha", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Factor  V", "Factor V", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("FIX", "Factor IX", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("FVIII IA", "Factor VIII Inhibitor Assay", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Factor VIII IA", "Factor VIII Inhibitor Assay", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("fibrinogen antigen", "Fibrinogen Antigen", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("fibrinogen Antigen", "Fibrinogen Antigen", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Protein S", "Free Protein S", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Protein C", "Protein C Activity", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Protein C Activity Activity", "Protein C Activity", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("HIT-IgG", "HIT IgG", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Heparin Anti-Xa", "Anti-Xa", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Free Free Protein S", "Free Protein S", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("FVIII", "Factor VIII", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Factor XIII Ag", "Factor XIII Antigen", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("FXIII AG", "Factor XIII Antigen", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("Heparin ratio", "Heparin Ratio", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("APTT - Heparin Dosage", "Heparin Ratio", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("ILVWF Ag", "vWF Antigen", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("ILVWF", "vWF Antigen", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("VWF Ag", "vWF Antigen", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("VWF Antigen", "vWF Antigen", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("VWACT", "vWF Activity", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("VWF ACT", "vWF Activity", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
data$Assay <- gsub("VWF Activity", "vWF Activity", data$Assay)
data$Assay <- as.factor(data$Assay)
levels(data$Assay)
summary(df.neqas)
df.neqas <- select(df.neqas, Date, Assay, Result, Median_Reagent, Median_Overall, IQ_Result)
df.neqas %>% arrange(Date)
any(is.na(df.neqas))
sum(complete.cases(df.neqas))
df.neqas.IQ <- filter(df.neqas, IQ_Result != "NA") %>% droplevels
summary(df.neqas.IQ)
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar()
levels(data$Assay)
df.neqas <- filter(data, Scheme =="NEQAS") %>% droplevels
df.neqas <- select(df.neqas, Date, Assay, Result, Median_Reagent, Median_Overall, IQ_Result)
summary(df.neqas)
df.neqas %>% arrange(Date)
any(is.na(df.neqas))
sum(complete.cases(df.neqas))
df.neqas.IQ <- filter(df.neqas, IQ_Result != "NA") %>% droplevels
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar()
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar()
ggplot(data=df.neqas.IQ, aes(x=IQ_Result)) + geom_bar()
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar()
summary(df.ecat)
missmap(df.ecat, main = "ECAT",  col = c("yellow", "black"), legend = FALSE)
df.ecat <- select(df.ecat, Date, Assay, Result, Median_Reagent, Z_Score)
summary(df.ecat)
Z-Score.no.na <- filter(df.ecat, Z_Score != "NA")
Z_Score.no.na <- filter(df.ecat, Z_Score != "NA")
summary(Z_Score.no.na)
Z_Score.no.na <- filter(df.ecat, Z_Score != "NA") %>% droplevels
summary(Z_Score.no.na)
ggplot(data=Z_Score.no.na, aes(x=Z_Score, fill=Assay)) + geom_histogram()
ggplot(data=Z_Score.no.na, aes(x=Z_Score, fill=Assay)) + geom_histogram(bins=30)
ggplot(data=Z_Score.no.na, aes(x=Z_Score, fill=Assay)) + geom_histogram(bins=50)
df.ecat <- filter(data, Scheme == "ECAT") %>% droplevels
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar(position="stack")
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar(aes(position="stack")
# ecat data
summary(df.ecat)
df.ecat <- select(df.ecat, Date, Assay, Result, Median_Reagent, Z_Score)
Z_Score.no.na <- filter(df.ecat, Z_Score != "NA") %>% droplevels
summary(Z_Score.no.na)
ggplot(data=Z_Score.no.na, aes(x=Z_Score, fill=Assay)) + geom_histogram(bins=50)
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar(aes(position="stack"))
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar(Position="Stack")
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar(position="Stack")
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar(position="Stack")
ggplot(data=df.neqas.IQ, aes(x=IQ_Result, fill=Assay)) + geom_bar(position="stack")
summary(Z_Score.no.na)
ggplot(data=Z_Score.no.na, aes(x=Date, y=Z_Score)) + geom_point()
ggplot(data=Z_Score.no.na, aes(x=Date, y=Z_Score, fill=Assay)) + geom_point()
ggplot(data=Z_Score.no.na, aes(x=Date, y=Z_Score, color=Assay)) + geom_point()
ggplot(data=Z_Score.no.na, aes(x=Date, y=Z_Score, color=Assay)) + geom_point()
ggplot(data=Z_Score.no.na, aes(x=Date, y=Z_Score, color=Assay, size=Result)) + geom_point()
ggplot(data=Z_Score.no.na, aes(x=Date, y=Z_Score, color=Assay, size=Result)) + geom_point() +
geom_line()
ggplot(data=Z_Score.no.na, aes(x=Date, y=Z_Score, color=Assay, size=Result)) + geom_point() +
geom_line(size=2)
ggplot(data=Z_Score.no.na, aes(x=Date, y=Z_Score, color=Assay, size=Result)) + geom_point()
ggplot(data=Z_Score.no.na, aes(x=Date, y=Result, color=Assay, size=Z_Score)) + geom_point()
ggplot(data=Z_Score.no.na, aes(x=Date, y=Z_Score, color=Assay, size=Result)) + geom_point()
summary(df.ecat)
library(stringr)
df.tg.ecat <- filter(df.ecat, str_detect(Assay, "TG"))
head(df.tg.ecat)
levels(df.ecat)
levels(df.ecat$Assay)
df.tg.ecat <- df.tg.ecat %>% select(Assay, Result, Median_Reagent)
head(df.tg.ecat)
summary(df.tg.ecat)
df.tg.ecat <- filter(df.ecat, str_detect(Assay, "TG")) %>% droplevels
df.tg.ecat <- df.tg.ecat %>% select(Assay, Result, Median_Reagent)
head(df.tg.ecat)
summary(df.tg.ecat)
df.diff.results <- df.tg.ecat %>%
mutate(Difference = Result - Median_Reagent)
head(df.diff.results)
df.diff.results <- df.tg.ecat %>%
mutate(Difference = ((Result - Median_Reagent)/Median_Reagent)*100)
head(df.diff.results)
df.diff.results
ggplot(data=df.diff.results, aes(x=Result, y=Median_Reagent, size = Difference)) +
geom_point()
ggplot(data=df.diff.results, aes(x=Result, y=Median_Reagent, size = Difference, color=Assay)) +
geom_point()
df.tg.ecat <- filter(df.tg.ecat, Result > 4000)
head(df.tg.ecat)
summary(df.tg.ecat)
df.tg.ecat <- filter(df.tg.ecat, Result > 4000) %>% droplevels
df.tg.ecat <- df.tg.ecat %>% select(Assay, Result, Median_Reagent)
head(df.tg.ecat)
summary(df.tg.ecat)
summary(df.ecat)
df.tg.ecat <- filter(df.ecat, str_detect(Assay, "TG")) %>% droplevels
df.tg.ecat <- filter(df.tg.ecat, Result < 4000) %>% droplevels
df.tg.ecat <- df.tg.ecat %>% select(Assay, Result, Median_Reagent)
head(df.tg.ecat)
summary(df.tg.ecat)
df.diff.results <- df.tg.ecat %>%
mutate(Difference = ((Result - Median_Reagent)/Median_Reagent)*100)
head(df.diff.results)
ggplot(data=df.diff.results, aes(x=Result, y=Median_Reagent, size = Difference, color=Assay)) +
geom_point()
ggplot(data=df.diff.results, aes(x=Result, y=Median_Reagent, color=Assay)) +
geom_point()
ggplot(data=df.diff.results, aes(x=Result, y=Median_Reagent)) +
geom_point() +
facet_wrap(~Assay)
ggplot(data=df.diff.results, aes(x=Result, y=Median_Reagent)) +
geom_point() +
facet_wrap(~Assay, scales="free")
summary(df.neqas)
summary(df.neqas.IQ)
classify <- function(x){
if (x == "APCR"){
return("Thrombotic")
}elseif(x == "Factor VIII"){
return("Bleeder")
}else{
return("Miscellaneous")
}
}
classify <- function(x){
if (x == "APCR"){
return("Thrombotic")
}else{
if(x == "Factor VIII"){
return("Bleeder")
}else{
return("Miscellaneous")
}
}
}
classify(APC)
classify("APC")
classify("APCR")
classify("Factor VIII")
classify("ADAMTS13")
classify(df.neqas.IQ$Assay)
for (i in assay){
classify(df.neqas.IQ$Assay)
}
classification <- NULL
classification <- NULL
for (i in assay){
classify(i)
return(classification[i])
}
classification <- NULL
for (i in df.neqas.IQ){
classify(i)
return(classification[i])
}
classification <- NULL
for (i in df.neqas.IQ){
classify(i)
classification <- classify(i)
}
for (i in df.neqas.IQ){
classify(i)
classification <- classify(i)
}
for (i in df.neqas.IQ){
classify(i)
}
for (i in df.neqas.IQ$Assay){
classify(i)
}
classification <- NULL
for (i in df.neqas.IQ$Assay){
classification <- classify(i)
}
classification
for (i in df.neqas.IQ$Assay){
print(classify(i))
}
View(df.neqas.IQ)
classify <- function(x){
if (x == "Anti-Xa"){
return("Thrombotic")
}else{
if(x == "Factor VIII"){
return("Bleeder")
}else{
return("Miscellaneous")
}
}
}
for (i in df.neqas.IQ$Assay){
print(classify(i))
}
for (i in df.neqas.IQ$Assay){
new.vec <- classify(i)
}
new.vec
new.vec <- NULL
for (i in df.neqas.IQ$Assay){
new.vec <- classify(i)
}
new.vec
new.vec
head(new.vec)
classify <- function(x){
if (x == "Anti-Xa"){
return("Thrombotic")
}else{
if(x == "Factor VIII"){
return("Bleeder")
}else{
return("Miscellaneous")
}
}
}
new.vec <- NULL
for (i in df.neqas.IQ$Assay){
new.vec <- classify(i)
}
new.vec
for (i in df.neqas.IQ$Assay){
print(classify(i))
}
classify <- function(x){
if (x == "Anti-Xa" | "D-Dimer"){
return("Thrombotic")
}else{
if(x == "Factor VIII"){
return("Bleeder")
}else{
return("Miscellaneous")
}
}
}
for (i in df.neqas.IQ$Assay){
print(classify(i))
}
classify <- function(x){
if (x == "Anti-Xa" | x == "D-Dimer"){
return("Thrombotic")
}else{
if(x == "Factor VIII"){
return("Bleeder")
}else{
return("Miscellaneous")
}
}
}
for (i in df.neqas.IQ$Assay){
print(classify(i))
}
sapply(df.neqas.IQ, classify)
sapply(df.neqas.IQ, classify())
sapply(df.neqas.IQ$Assay, classify())
?sapply
sapply(df.neqas.IQ$Assay, classify)
levels(df.neqas.IQ)
summary(df.neqas.IQ)
levels(df.neqas.IQ$Assay)
classify <- function(x){
if (x == "Antithrombin" | x == "APCR"){
return("Thrombotic")
}else{
if(x == "Factor VIII"){
return("Bleeder")
}else{
return("Miscellaneous")
}
}
}
sapply(df.neqas.IQ$Assay, classify)
classify <- function(x){
if (x == "Antithrombin" | x == "APCR" | x == "Free Protein S"| x == "Protein C Activity"){
return("Thrombotic")
}else{
if(x == "Anti-Xa"| x == "D-Dimer"| x == "Heparin Ratio"){
return("Routine")
}else
if(x == "vWF Activity" | x == "vWF Antigen"| x == "VWF CBA"| x == "VWF: Rco Activity"){
return("von Willebrand")
}else{
return("Bleeder")
}
}
}
sapply(df.neqas.IQ$Assay, classify)
df.neqas.IQ$Classification <- sapply(df.neqas.IQ$Assay, classify)
vec.new <- sapply(df.neqas.IQ$Assay, classify)
vec.new
dim(df.neqas.IQ)
df.neqas.classified <- cbind(df.neqas.IQ, vec.new)
head(df.neqas.classified)
classify <- function(x){
if (x == "Antithrombin" | x == "APCR" | x == "Free Protein S"| x == "Protein C Activity"){
return("Thrombotic")
}else{
if(x == "Anti-Xa"| x == "D-Dimer"| x == "Heparin Ratio"){
return("Routine")
}else
if(x == "vWF Activity" | x == "vWF Antigen"| x == "VWF CBA"| x == "VWF: Rco Activity"){
return("von Willebrand")
}else{
return("Factor")
}
}
}
vec.new <- sapply(df.neqas.IQ$Assay, classify)
vec.new
df.neqas.classified <- cbind(df.neqas.IQ, vec.new)
head(df.neqas.classified)
df.neqas.IQ$Assay
df.neqas.IQ
levels(df.neqas.IQ$Assay)
summary(df.neqas.IQ)
df.neqas.classified %>% select(-Classification)
df.neqas.classified
df.neqas.classified %>% arrange(Median_Overall)
df.neqas.classified %>% arrange(Median_Overall, desc)
class(vec.new)
as.factor(vec.new)
class(Median_Overall)
head(df.neqas.classified)
class(df.neqas.classified$Median_Overall)
df.neqas.classified %>% arrange(Median_Overall, desc)
df.neqas.classified %>% arrange(Median_Overall, desc=T)
df.neqas.classified %>% arrange(desc(Median_Overall))
